@page "/Landing/{Casestudy}"
@using LeverageTechnology.Shared;

@inject ApiService ApiService


<MudText Class="ml-4" Align="Align.Center" Color="Color.Secondary" Typo="Typo.h6">@Introduction</MudText>
<MudTabs Elevation="4" Rounded="true" Centered="true" AlwaysShowScrollButtons="true" Style="@($"color:{Colors.Indigo.Darken4}")" Class="mt-4 mr-5 ml-5">

    @foreach (var item in @Casestudies)
    {
        var videosrc = "https://player.vimeo.com/video/" + @item.Video + '?';
        <MudTabPanel Text="@item.Title">
            <MudGrid Elevation="1" Class="py-8 px-10">
                <MudItem Class="mt-1" xs="12" Style="height: fit-content;">
                    <MudText Class="mt-1" Typo="Typo.h4" Align="Align.Center" Color="Color.Primary">@item.Summary</MudText>

                    <MudContainer Class="mt-1 row">
                        <div class="col-lg-12 col-md-12 col-sm-12">
                            <div class="container" style="padding:56.25% 0 0 0;position:relative;">
                                <iframe class="responsive-iframe" src="@videosrc;autopause=0&amp;player_id=0&amp;app_id=58479" frameborder="0"
                                        allow="autoplay; fullscreen; picture-in-picture" style="position:absolute;top:0;left:0;width:100%;height:100%;"
                                        title="@item.Title">
                                </iframe>
                            </div>
                        </div>

                    </MudContainer>
                </MudItem>
                <MudItem>

                </MudItem>
            </MudGrid>
        </MudTabPanel>
    }
</MudTabs>

@code {
    [Parameter]
    public string Casestudy { get; set; }
    public string Introduction { get; set; }
    public List<CaseStudy> Casestudies { get; set; }

    protected async override Task OnInitializedAsync()
    {
        var intro = ApiService.Intros.FirstOrDefault(x => x.Title == Casestudy);
        Introduction = intro.Introduction;
        Casestudies = ApiService.CaseStudies.Where(x => x.Page == intro.Page).ToList();


    }
    protected override void OnParametersSet()
    {
        var intro = ApiService.Intros.FirstOrDefault(x => x.Title == Casestudy);
        Introduction = intro.Introduction;
        Casestudies = ApiService.CaseStudies.Where(x => x.Page == intro.Page).ToList();
    }
}
