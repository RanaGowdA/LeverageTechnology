@page "/Landing/{Casestudy}"
@using LeverageTechnology.Shared;

@inject ApiService ApiService 

<MudTabs Outlined="true" Position="Position.Top" Rounded="true" Border="true"
         ApplyEffectsToContainer="true"Class="mt-4 mr-5 ml-5" PanelClass="pa-6" Style="height100%">

    @foreach (var item in @Casestudies)
    {
        var videosrc = "https://player.vimeo.com/video/" + @item.Video +'?';
        <MudTabPanel Text="@item.Title">
            <MudCard Class="mt-1 mr-5 ml-5">
                <MudCardHeader>
                    @* <CardHeaderAvatar>
                <MudAvatar Color="Color.Secondary">I</MudAvatar>
                </CardHeaderAvatar>*@
                    <CardHeaderContent>
                        <MudText Typo="Typo.h5">@item.Summary</MudText>
                    </CardHeaderContent>
                    <CardHeaderActions>
                        @*<MudIconButton Icon="@Icons.Material.Filled.Settings" Color="Color.Default" />*@
                    </CardHeaderActions>
                </MudCardHeader>
                <div style="padding:56.25% 0 0 0;position:relative;">

                    <iframe src="@videosrc;autopause=0&amp;player_id=0&amp;app_id=58479" frameborder="0"
                            allow="autoplay; fullscreen; picture-in-picture" style="position:absolute;top:0;left:0;width:100%;height:100%;"
                            title="@item.Title">
                    </iframe>
                </div>
                @* <MudCardContent>
            <MudText Typo="Typo.body2">This photo was taken in a small village in Istra Croatia.</MudText>
            </MudCardContent>
            <MudCardActions>
            <MudIconButton Icon="@Icons.Material.Filled.Favorite" Color="Color.Default" />
            <MudIconButton Icon="@Icons.Material.Filled.Share" Color="Color.Default" />
            </MudCardActions>*@
            </MudCard>
        </MudTabPanel>
    }
</MudTabs>

@code {
    [Parameter]
    public string Casestudy { get; set; }
    public List<CaseStudy> Casestudies { get; set; }

    protected async override Task OnInitializedAsync()
    {
        var intro = ApiService.Intros.FirstOrDefault(x => x.Title == Casestudy);
        Casestudies = ApiService.CaseStudies.Where(x => x.Page == intro.Page).ToList();


    }
    protected override void OnParametersSet()
    {
        var intro = ApiService.Intros.FirstOrDefault(x => x.Title == Casestudy);
        Casestudies = ApiService.CaseStudies.Where(x => x.Page == intro.Page).ToList();
    }
}
